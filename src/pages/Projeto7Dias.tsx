import { useState } from "react";
import Navigation from "@/components/Navigation";
import Footer from "@/components/Footer";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Checkbox } from "@/components/ui/checkbox";
import { ChevronLeft, ChevronRight, Calendar, Info } from "lucide-react";
import sleepRoutineImage from "@/assets/sleep-routine.jpg";
import healthyLifestyleImage from "@/assets/healthy-lifestyle.jpg";

const Projeto7Dias = () => {
  const [currentDay, setCurrentDay] = useState(1);
  const [checkedItems, setCheckedItems] = useState<Record<number, boolean[]>>({});

  const dailyProgram = [
    {
      day: 1,
      title: "Estabelecendo a Base",
      description: "A consist√™ncia √© o alicerce do bom sono. Hoje, voc√™ criar√° a estrutura fundamental para todas as pr√≥ximas noites.",
      tasks: [
        "Defina um hor√°rio fixo para dormir e acordar (mesmo nos fins de semana)",
        "Evite cafe√≠na ap√≥s √†s 14h (caf√©, ch√°s, refrigerantes e chocolate)",
        "Desligue todas as telas 1 hora antes de dormir",
        "Tome um banho morno 30-60 minutos antes de deitar",
        "Prepare seu quarto: escuro, silencioso e temperatura entre 18-22¬∞C",
        "Anote a hora que dormiu e acordou para acompanhar seu progresso"
      ],
      tip: "üí° Use um despertador real em vez do celular para n√£o ter a tenta√ß√£o de mexer no telefone na cama."
    },
    {
      day: 2,
      title: "Construindo uma Rotina Noturna",
      description: "Criar um ritual noturno sinaliza ao c√©rebro que √© hora de desacelerar. Rituais reduzem a ansiedade noturna em at√© 60%.",
      tasks: [
        "Mantenha rigorosamente os hor√°rios estabelecidos no dia 1",
        "Pratique 10 minutos de respira√ß√£o profunda (use nossa p√°gina de exerc√≠cios)",
        "Leia um livro f√≠sico por 20-30 minutos (evite conte√∫do estimulante)",
        "Evite refei√ß√µes pesadas 3h antes de dormir",
        "Prepare sua roupa e bolsa para o pr√≥ximo dia (reduz ansiedade)",
        "Anote 3 coisas positivas do seu dia em um di√°rio de gratid√£o"
      ],
      tip: "üí° Mantenha uma garrafa d'√°gua ao lado da cama, mas evite beber muito l√≠quido 2h antes de dormir."
    },
    {
      day: 3,
      title: "Movimento e Energia",
      description: "Exerc√≠cios regulares melhoram a qualidade do sono em 65%. O momento certo faz toda a diferen√ßa.",
      tasks: [
        "Fa√ßa 30 minutos de exerc√≠cio aer√≥bico pela manh√£ ou tarde",
        "Caminhe ao ar livre para pegar luz natural (regula o ritmo circadiano)",
        "Evite exerc√≠cios intensos ap√≥s √†s 19h",
        "Pratique 15 minutos de alongamento suave antes de dormir",
        "Mantenha toda a rotina noturna dos dias anteriores",
        "Tome um ch√° relaxante (camomila, valeriana ou maracuj√°)",
        "Se exercitou √† noite, espere 2-3h antes de dormir"
      ],
      tip: "üí° Exerc√≠cios matinais s√£o ideais: aumentam a energia diurna e melhoram o sono noturno."
    },
    {
      day: 4,
      title: "Mente Calma, Corpo Relaxado",
      description: "A medita√ß√£o e mindfulness reduzem o tempo para adormecer em 50% e melhoram a qualidade do sono profundo.",
      tasks: [
        "Medite por 15 minutos durante o dia (use apps como Insight Timer)",
        "Pratique yoga suave, tai chi ou body scan antes de dormir",
        "Evite discuss√µes e decis√µes importantes √† noite",
        "Fa√ßa uma lista das preocupa√ß√µes e deixe-a fora do quarto",
        "Ou√ßa m√∫sica instrumental calma (60-80 BPM) enquanto se prepara para dormir",
        "Use aromaterapia com lavanda (travesseiro, difusor ou √≥leo essencial)",
        "Pratique a t√©cnica 4-7-8 na cama (veja nossa p√°gina de exerc√≠cios)"
      ],
      tip: "üí° Se pensamentos ansiosos aparecerem, anote-os em um papel e retome pela manh√£. Libere sua mente."
    },
    {
      day: 5,
      title: "Nutri√ß√£o para o Sono",
      description: "O que voc√™ come afeta diretamente seu sono. Certos nutrientes promovem a produ√ß√£o de melatonina e serotonina.",
      tasks: [
        "Reduza l√≠quidos 2h antes de dormir (evita despertar noturno)",
        "Inclua alimentos ricos em triptofano no jantar (banana, aveia, nozes, peru)",
        "Evite √°lcool √† noite (fragmenta o sono e reduz sono REM)",
        "Evite alimentos picantes, gordurosos ou muito a√ßucarados √† noite",
        "Se sentir fome antes de dormir, fa√ßa lanche leve (banana com mel, leite morno)",
        "Considere suplementos naturais: magn√©sio, melatonina (consulte um m√©dico)",
        "Mantenha todas as pr√°ticas dos 4 dias anteriores"
      ],
      tip: "üí° Uma x√≠cara de leite dourado (leite com c√∫rcuma e mel) 1h antes de dormir pode melhorar muito o sono."
    },
    {
      day: 6,
      title: "Santu√°rio do Sono",
      description: "Seu ambiente de sono pode melhorar a qualidade do sono em at√© 50%. Transforme seu quarto em um santu√°rio.",
      tasks: [
        "Ajuste a temperatura do quarto para 18-22¬∞C (ideal para sono profundo)",
        "Use cortinas blackout ou m√°scara de dormir (bloqueie 100% da luz)",
        "Experimente ru√≠do branco, ventilador ou sons da natureza (mascara ru√≠dos)",
        "Avalie seu colch√£o e travesseiro (devem dar suporte adequado)",
        "Remova todos os eletr√¥nicos do quarto (TV, celular, tablets)",
        "Use roupa de cama confort√°vel e respire",
        "Considere usar meias para dormir (melhora a circula√ß√£o)",
        "Mantenha o quarto limpo e organizado (reduz estresse visual)"
      ],
      tip: "üí° Seu quarto deve ser usado APENAS para dormir e intimidade. Treine seu c√©rebro a associar o quarto ao sono."
    },
    {
      day: 7,
      title: "Reflex√£o e Continuidade",
      description: "Parab√©ns por completar os 7 dias! Agora √© hora de consolidar seus aprendizados e planejar o futuro.",
      tasks: [
        "Revise seu di√°rio de sono da semana (hor√°rios, qualidade, despertar)",
        "Identifique as 3-5 pr√°ticas que mais funcionaram para voc√™",
        "Crie um plano de manuten√ß√£o com as t√©cnicas mais efetivas",
        "Defina metas de sono para o pr√≥ximo m√™s",
        "Celebre seu progresso e reconhe√ßa as mudan√ßas positivas",
        "Compartilhe sua experi√™ncia com amigos ou familiares",
        "Continue usando pelo menos 3 t√©cnicas diariamente",
        "Agende uma revis√£o em 30 dias para avaliar progresso cont√≠nuo"
      ],
      tip: "üí° H√°bitos levam 21-66 dias para se consolidarem. Continue praticando! Voc√™ est√° no caminho certo."
    }
  ];

  const program = dailyProgram[currentDay - 1];

  const toggleTask = (taskIndex: number) => {
    setCheckedItems(prev => ({
      ...prev,
      [currentDay]: {
        ...prev[currentDay],
        [taskIndex]: !prev[currentDay]?.[taskIndex]
      }
    }));
  };

  const completedTasks = Object.values(checkedItems[currentDay] || {}).filter(Boolean).length;
  const totalTasks = program.tasks.length;
  const progress = (completedTasks / totalTasks) * 100;

  return (
    <div className="min-h-screen bg-background">
      <Navigation />
      
      <div className="pt-20 sm:pt-24 pb-12 px-4">
        <div className="container mx-auto max-w-4xl">
          <div className="text-center mb-8 sm:mb-12">
            <h1 className="text-3xl sm:text-4xl md:text-5xl font-bold mb-3 sm:mb-4 bg-gradient-lavender bg-clip-text text-transparent">
              Programa de 7 Dias
            </h1>
            <p className="text-base sm:text-lg text-muted-foreground px-4">
              Um guia completo e estruturado para transformar seu sono. 
              Siga cada dia e marque suas conquistas!
            </p>
          </div>

          {/* Info Card */}
          <Card className="mb-6 sm:mb-8 bg-primary/10 border-primary/30">
            <CardContent className="pt-6">
              <div className="flex flex-col sm:flex-row items-start sm:items-center gap-4">
                <div className="flex-shrink-0">
                  <Info className="h-6 w-6 sm:h-8 sm:w-8 text-primary" />
                </div>
                <div className="space-y-2 text-sm sm:text-base">
                  <p className="text-foreground font-semibold">
                    Como aproveitar ao m√°ximo este programa:
                  </p>
                  <ul className="text-muted-foreground space-y-1 text-xs sm:text-sm">
                    <li>‚úì Siga as tarefas em ordem e marque cada uma ao completar</li>
                    <li>‚úì Leia as dicas do dia - elas cont√™m informa√ß√µes valiosas</li>
                    <li>‚úì Seja consistente: resultados aparecem com pr√°tica di√°ria</li>
                    <li>‚úì Adapte as t√©cnicas √† sua realidade, mas n√£o pule dias</li>
                  </ul>
                </div>
              </div>
            </CardContent>
          </Card>

          {/* Day Selector */}
          <div className="flex items-center justify-center gap-3 sm:gap-4 mb-6 sm:mb-8">
            <Button
              variant="secondary"
              size="icon"
              onClick={() => setCurrentDay(Math.max(1, currentDay - 1))}
              disabled={currentDay === 1}
              className="flex-shrink-0"
            >
              <ChevronLeft className="h-4 w-4" />
            </Button>
            
            <div className="flex items-center gap-2 bg-card px-4 sm:px-6 py-2 sm:py-3 rounded-lg border border-border">
              <Calendar className="h-4 w-4 sm:h-5 sm:w-5 text-primary" />
              <span className="text-lg sm:text-xl font-bold">Dia {currentDay}</span>
            </div>
            
            <Button
              variant="secondary"
              size="icon"
              onClick={() => setCurrentDay(Math.min(7, currentDay + 1))}
              disabled={currentDay === 7}
              className="flex-shrink-0"
            >
              <ChevronRight className="h-4 w-4" />
            </Button>
          </div>

          {/* Day Progress */}
          <div className="flex gap-1.5 sm:gap-2 mb-6 sm:mb-8 px-2">
            {dailyProgram.map((_, index) => (
              <button
                key={index}
                onClick={() => setCurrentDay(index + 1)}
                aria-label={`Ir para dia ${index + 1}`}
                className={`flex-1 h-2 sm:h-2.5 rounded-full transition-all ${
                  index + 1 === currentDay
                    ? "bg-primary shadow-glow"
                    : index + 1 < currentDay
                    ? "bg-accent"
                    : "bg-secondary"
                }`}
              />
            ))}
          </div>

          {/* Daily Card */}
          <Card className="bg-card border-border shadow-soft">
            <CardHeader>
              <CardTitle className="text-xl sm:text-2xl text-foreground">{program.title}</CardTitle>
              <CardDescription className="text-sm sm:text-base mt-2">
                {program.description}
              </CardDescription>
              <div className="mt-4">
                <div className="flex justify-between items-center mb-2">
                  <span className="text-xs sm:text-sm text-muted-foreground">
                    Progresso do Dia
                  </span>
                  <span className="text-xs sm:text-sm font-semibold text-foreground">
                    {completedTasks} de {totalTasks} ({Math.round(progress)}%)
                  </span>
                </div>
                <div className="w-full bg-secondary h-2.5 rounded-full overflow-hidden">
                  <div
                    className="h-full bg-gradient-lavender transition-all duration-500"
                    style={{ width: `${progress}%` }}
                  />
                </div>
              </div>
            </CardHeader>
            <CardContent>
              <div className="space-y-3 sm:space-y-4">
                {program.tasks.map((task, index) => (
                  <div
                    key={index}
                    className="flex items-start gap-3 p-3 sm:p-4 rounded-lg hover:bg-secondary/50 transition-colors border border-transparent hover:border-border"
                  >
                    <Checkbox
                      id={`task-${index}`}
                      checked={checkedItems[currentDay]?.[index] || false}
                      onCheckedChange={() => toggleTask(index)}
                      className="mt-1 flex-shrink-0"
                    />
                    <label
                      htmlFor={`task-${index}`}
                      className={`flex-1 cursor-pointer text-sm sm:text-base leading-relaxed ${
                        checkedItems[currentDay]?.[index]
                          ? "line-through text-muted-foreground"
                          : "text-foreground"
                      }`}
                    >
                      {task}
                    </label>
                  </div>
                ))}
              </div>

              {/* Day Tip */}
              {program.tip && (
                <div className="mt-6 p-4 bg-primary/10 rounded-lg border border-primary/30">
                  <p className="text-sm sm:text-base text-foreground leading-relaxed">
                    {program.tip}
                  </p>
                </div>
              )}
            </CardContent>
          </Card>

          {/* Motivational Images */}
          {(currentDay === 1 || currentDay === 7) && (
            <div className="mt-8 grid sm:grid-cols-2 gap-4">
              <img 
                src={sleepRoutineImage} 
                alt="Rotina de sono saud√°vel"
                className="w-full h-48 object-cover rounded-lg shadow-soft"
              />
              <img 
                src={healthyLifestyleImage} 
                alt="Estilo de vida saud√°vel"
                className="w-full h-48 object-cover rounded-lg shadow-soft"
              />
            </div>
          )}

          <div className="mt-6 sm:mt-8 text-center space-y-3">
            <p className="text-sm sm:text-base text-muted-foreground px-4 leading-relaxed">
              üåô Lembre-se: consist√™ncia √© a chave para o sucesso. Cada dia conclu√≠do √© um passo 
              em dire√ß√£o a noites tranquilas e dias energizados!
            </p>
            {currentDay === 7 && completedTasks === totalTasks && (
              <p className="text-base sm:text-lg font-semibold text-primary">
                üéâ Parab√©ns por completar o programa de 7 dias! Continue praticando suas t√©cnicas favoritas.
              </p>
            )}
          </div>
        </div>
      </div>

      <Footer />
    </div>
  );
};

export default Projeto7Dias;
